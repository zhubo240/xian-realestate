# 西安房地产数据集项目 - 探索记录

> 日期：2026-02-09

## 项目目标

建立一个西安所有小区的数据集，包含：
- 小区名称、位置、建成年份
- 总户数、容积率、绿化率
- 均价、户型面积
- 经纬度坐标（用于地图展示）

---

## 一、现有数据源调研

### 1. 商业数据库

**禧泰全国房地产数据库** (creprice.cn)
- 数据规模：337 城市、71.9 万小区、143 亿条交易记录
- 粒度：全国 → 市 → 区县 → 街镇 → 小区级
- 收费：城市会员 500 元/月，城市高级会员 1 万元/年（6000 小区），全国 15 万元/年
- 结论：可作为数据对比参考标准

### 2. 公开数据集

- Kaggle 上无西安小区级数据集
- 国家统计局有宏观房价数据，粒度不够
- 没有找到直接可用的西安小区级开源数据集

### 3. 房产网站

| 网站 | 反爬程度 | 数据丰富度 | 测试结果 |
|------|---------|-----------|---------|
| 贝壳 (ke.com) | 严 | 非常丰富 | 直接跳转封禁页面 |
| 链家 (lianjia.com) | 严 | 非常丰富 | 跳转验证码页面 |
| 房天下 (fang.com) | 松 | 丰富 | ✅ 成功抓取 |
| 安居客 (anjuke.com) | 中等 | 丰富 | 未深入测试 |

---

## 二、开源爬虫项目评估

### 已测试

**jumper2014/lianjia-beike-spider** (JimCarry fork)
- 原仓库已删除，使用 fork 版本
- 支持 21 个城市，原版不含西安，已手动添加 `xa: 西安`
- 测试结果：贝壳和链家均返回 0 条数据（反爬机制升级，无法获取区县列表）
- 结论：❌ 已失效

### 调研未测试

| 项目 | 数据源 | 特点 | 状态 |
|------|--------|------|------|
| xjkj123/Lianjia | 链家地图 API | 60+ 字段、含经纬度、API 逆向绕过反爬 | 不支持西安，可扩展 |
| SeaEagleI/house_price_analysis | 贝壳 + 高德 | 含高德经纬度获取逻辑 | ~2023，可参考 |
| ctkqiang/LianJiaScraper | 链家 | Spring Boot 架构 | 需要 Java |
| dai08170/airealestate | 链家 | 全国房源 + AI 分析 | 2021，较旧 |
| CaoZ/Fast-LianJia-Crawler | 链家 API | 3 分钟抓万级小区 | 2017，太旧 |

**xjkj123/Lianjia 分析：**
- 优势：通过逆向链家地图 API 参数获取数据，不走网页，可绕过验证码
- 能抓：小区名、均价、经纬度、建成年份
- 不能抓：总户数、容积率、绿化率
- 结论：仍然需要第二个数据源补充详细信息，和直接用房天下区别不大

---

## 三、经纬度获取方案

| 方案 | 结果 |
|------|------|
| 高德地图网页版 | 反爬，搜索结果未加载 |
| 高德 API (restapi.amap.com) | 需要 API key（`demo` key 无效） |
| Nominatim (OpenStreetMap) | 被限流/封禁 |
| OpenStreetMap 网页搜索 | ✅ 部分小区可查到，但覆盖不全 |

**结论：申请高德地图 API key（免费，每天 5000 次）是最可靠的方案**

---

## 四、测试数据采集结果

### 曲江一期 10 个小区（房天下 + OSM）

已保存到 `qujiang_communities.csv`：

| 小区 | 均价(元/㎡) | 总户数 | 容积率 | 建成年份 | 坐标精度 |
|------|-----------|--------|--------|---------|---------|
| 曲江公馆和园 | 61,556 | 1,052 | 1.88 | 2012 | OSM 精确 |
| 中海百贤府 | 46,597 | 104 | 0.80 | 2014 | 近似 |
| 中海铂宫 | 40,526 | 543 | 2.40 | 2012 | OSM 精确 |
| 金地湖城大境 | 38,921 | 3,069 | 1.20 | 2012 | 近似 |
| 中海御湖公馆 | 29,118 | 2,046 | 3.56 | 2014 | 近似 |
| 紫薇永和坊 | 22,947 | 2,200 | 2.70 | 2013 | 近似 |
| 曲江汇景新都 | 20,298 | — | — | 2004 | 近似 |
| 曲江春晓苑 | 19,715 | 1,212 | 1.70 | 2004 | 近似 |
| 丰景佳园 | 19,524 | 1,004 | 2.30 | 2004 | 近似 |
| 曲江假日新嘉园 | 18,410 | 376 | 1.40 | 2003 | 近似 |

### 数据质量评估

- ✅ 基础数据（名称、均价、地址、年份）— 容易获取
- ✅ 详细数据（容积率、户数、户型）— 需逐个查，但可行
- ⚠️ 经纬度 — OSM 覆盖有限，需要高德 API 补充
- ⚠️ 部分小区（如曲江汇景新都）网上信息较少，数据不完整

---

## 五、最终方案（推荐）

**房天下 + 高德 API**

1. **房天下**抓取全部小区数据（名称、均价、地址、建成年份、总户数、容积率、绿化率、户型面积、物业费等）
2. **高德 API**（免费 key）批量地理编码，获取经纬度坐标
3. 数据清洗、去重、合并
4. 地图可视化展示

**优势：**
- 房天下反爬限制最松，已验证可行
- 高德 API 免费额度充足
- 不需要复杂的爬虫框架
- 数据字段最全

---

## 六、待办

- [ ] 申请高德地图 API key
- [ ] 编写房天下小区列表批量爬取脚本
- [ ] 编写小区详情页数据解析脚本
- [ ] 高德 API 批量地理编码
- [ ] 数据清洗合并
- [ ] 地图可视化

---

## 七、相关文件

- `qujiang_communities.csv` — 曲江一期 10 个小区测试数据
- `lianjia-beike-spider/` — 已 clone 的开源爬虫（已失效，仅作参考）
